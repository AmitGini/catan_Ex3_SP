# קטאן - מחלקות וירושה

המתיישבים של קטאן הוא משחק קופסא ל-3 עד 4 שחקנים המשלב הן חשיבה אסטרטגית, ניהול משאבים ויכולת מסחר. מטרת המשחק היא לצבור ראשון 10 נקודות ניצחון. את הוראות המשחק המלא ניתן למצוא כאן: [הוראות המשחק](https://www.hakubia.com/wp-content/uploads/2021/01/%D7%A7%D7%98%D7%90%D7%9F.pdf).

במטלה זו מימשנו גרסה פשוטה יותר של המשחק עבור 3 שחקנים.

## חוקי המשחק

המשחק מורכב מלוח המכיל 19 חלקות אדמה מוקפות בים. כל חלקת אדמה נותנת משאב כלשהו (חוץ מהמדבר). חלקות האדמה במשחק הן: יער (מניב עץ), גבעות (מניבות לבנים), אדמת מרעה (מניבה צמר), אדמה חקלאית (מניבה שיבולת), הרים (מניבים ברזל), מדבר (לא מניב כלום). כל חלקי המפה מקבלים מספר כלשהו בין 2 ל-12.

### קלפים, יישובים, ערים ומשאבים

כל שחקן בעל משאבים (כגון שיבולת, ברזל, לבנים וכו') יכול לרכוש איתם דברים שונים במשחק כמו קלפי פיתוח, יישובים, ערים ודרכים.

- **קלף פיתוח**: מחירו של קלף פיתוח הוא ברזל 1, צמר 1 ושיבולת 1. השחקן יכול לקבל אחד מ-3 סוגים שונים של קלפים:
  1. קלף קידום: קלף המעניק הטבה לשחקן (לאחר מכן הקלף נעלם). בין הקלפים הללו ניתן למצוא:
     - מונופול: השחקן בוחר משאב כלשהו וכל שאר השחקנים מחויבים להעביר לו את המשאב הזה.
     - בניית דרכים: השחקן יכול לבנות 2 דרכים במפה ללא עלות.
     - שנת שפע: השחקן זוכה לקבל מהבנק שני קלפים של משאבים לבחירה ולהשתמש בהם באותו התור.
  2. אבירים: שחקן המחזיק ב-3 קלפים כאלה מקבל את קלף הצבא הגדול ביותר המקנה לו 2 נקודות ניצחון (אם איבד אביר אחד, הקלף נלקח מהשחקן. יש בדיוק 3 קלפים כאלה).
  3. קלפי נקודות ניצחון: יש 4 קלפים שונים המעניקים נקודת ניצחון למי שמחזיק בהם.

- **בנייה**: ניתן לבנות דרכים, ערים ויישובים בצורה הבאה:
  1. קטע דרך: עלותו לבנים 1 ועץ 1. קטע דרך יכול להיות מחובר רק ליישוב (או עיר) בבעלות השחקן או לקטע דרך נוסף.
  2. יישוב: עלות היישוב היא לבנה 1, עץ 1, צמר 1 ושיבולת 1. ניתן לבנות יישוב על צומת שאליה מובילה דרך אחת לפחות ומברחק של 2 קטעי דרך מיישוב אחר. בניית יישוב מקנה לשחקן נקודת ניצחון אחת.
  3. עיר: עיר יכולה להחליף יישוב קיים. עלות הבנייה היא ברזל 3 ושיבולת 2. ברגע שמשדרגים יישוב לעיר, השחקן מאבד את הנקודה של היישוב ומקבל 2 נקודות על הבנייה. עיר מעניקה לשחקן פי-2 יותר משאבים מכל חבלי הארץ הסמוכים לה.

- **משאבים**: המשאבים מתקבלים מחבלי הארץ השונים. כאשר שחקן מטיל את קוביות המשחק, כל השחקנים מקבלים משאבים בהתאם למספר שיצא בהטלה (כלומר אם יצא 3 בהטלה, אז שחקנים עם יישובים/ערים הגובלים עם חבלי ארץ בעלי אותו מספר זוכים במשאב).

- **מסחר**: שחקנים יכולים לבצע מסחר ביניהם (כלומר להחליף קלפים או משאבים) בהתאם לאיך שהם קובעים.

### מהלך המשחק

כל שחקן מתחיל את המשחק עם 2 יישובים ו-2 קטעי דרך המעניקים לו 2 נקודות ניצחון. בנוסף, השחקנים מקבלים משאבים התחלתיים בהתאם למקומות שבהם הם מיקמו את היישובים (משאב אחד מכל משאב אפשרי).

סדר המשחק נקבע באופן שרירותי (לשיקולכם). בכל תור השחקנים מטילים 2 קוביות. בהתאם לתוצאת ההטלה, השחקנים מקבלים משאבים כמו שפורט מקודם.

שחקן בתור נתון עושה את הפעולות הבאות לפי הסדר (לאחר הטלת הקוביות):
- הוא יכול לסחור (כלומר להחליף קלפים או משאבים).
- הוא יכול לבנות דרכים, יישובים או ערים ויכול לקנות קלפי פיתוח.
- אם השחקן מנצל את אחד מקלפי הפיתוח שברשותו, התור אוטומטית עובר לשחקן הבא (השחקן יכול לנצל את קלף הפיתוח עוד לפני הטלת הקוביות, במקרה כזה התור עובר לשחקן הבא).
- אם סכום ההטלה הוא 7, על כל השחקנים בעלי יותר מ-7 קלפי משאבים לבחור מחצית מהקלפים ולהחזיר אותם לערימה.

### סיום המשחק

המשחק מסתיים בתור שבו אחד השחקנים הגיע ל-10 או יותר נקודות ניצחון. כדי לנצח במשחק, השחקן צריך שיגיע תורו ובאותו התור יהיו לו 10 נקודות לכל הפחות.

### דוגמת הרצה

מחלקת ה-Board אחראית לניהול הלוח של המשחק. היא כוללת את כל החלקות, הצמתים והדרכים. המחלקה משתמשת בתבנית סינגלטון על מנת להבטיח שיש רק לוח אחד בכל פעם.

```cpp
#include "Board.hpp"
#include "Player.hpp"
#include "Tile.hpp"
#include "Vertex.hpp"
#include "Edge.hpp"
#include "Card.hpp"
#include "KnightCard.hpp"
#include "VictoryPointCard.hpp"
#include "YearOfPlentyCard.hpp"
#include "RoadCard.hpp"
#include "MonopolyCard.hpp"

using namespace catan_game;

int main() {
    // Create players
    Player player1("Player1");
    Player player2("Player2");
    Player player3("Player3");

    // Get the board instance
    Board* board = Board::getBoardInstance();

    // Place settlements and roads for each player
    board->placeSettlement(0, 2, &player1, false, true);
    board->placeRoad(0, 2, 0, 3, &player1, true);

    board->placeSettlement(0, 4, &player2, false, true);
    board->placeRoad(0, 4, 0, 5, &player2, true);

    board->placeSettlement(0, 6, &player3, false, true);
    board->placeRoad(0, 6, 0, 7, &player3, true);

    // Simulate a turn
    player1.rollDice();
    player2.rollDice();
    player3.rollDice();

    // Print the board state
    board->printBoard();

    return 0;
}
```
